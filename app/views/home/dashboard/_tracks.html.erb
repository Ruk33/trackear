<div class="mt-10 flex items-center justify-between">
  <h1 class="text-2xl">Registros semanales</h1>

  <%= form_tag "/", id: :dashboard_filter, method: :get do %>
    <div class="flex items-center">
      <%= hidden_field_tag :from, params[:from] %>
      <%= hidden_field_tag :to, params[:to] %>
      <%# react_component("views/Dashboard", { formId: :dashboard_filter, fromFieldId: :from, toFieldId: :to }) %>
      <%= select_tag :project_id, options_for_select(@active_contracts.collect{ |c| [c.project.name, c.project.id] }, params[:project_id]), include_blank: "Todos los proyectos", onchange: "this.form.submit()", class: "ml-4 p-2 rounded shadow" %>
    </div>
  <% end %>
</div>

<% if @tracks.empty? %>
  <div class="text-xl text-gray-600 text-center pt-4 pb-2">No se encontraron registros.</div>
  <%= link_to "Limpiar filtros", "/", class: "text-lg block text-center" %>
<% end %>

<% @tracks.to_a.group_by { |d| d.from.beginning_of_week }.each do |date| %>
  <div class="mt-4 mb-16">
    <div class="flex items-center justify-between mb-2">
      <h2 class="text-xl text-gray-800"><%= week_title date[0] %></h2>
      <h4 class="text-lg text-gray-800">Total de la semana: <%= calculate_hours_from date[1] %></h4>
    </div>

    <% date[1].each do |track| %>
      <div class="mb-2">
        <%= render "projects/activity_tracks/show", log: track %>
      </div>
    <% end %>
  </div>
<% end %>
